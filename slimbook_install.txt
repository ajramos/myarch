```bash
loadkeys es
iwctl station wlan0 connect "MiWifi"
timedatectl set-ntp true
modprobe dm-crypt
modprobe dm-mod

fdisk /dev/nvme0n1

Crear 3 particiones
1) EFI 256M (no hace falta que empiece en el sector 34, puede empezar en el 2048)
2) Boot 512M
3) Root Resto

#Encriptar partición
cryptsetup luksFormat -v -s 512 -h sha512 /dev/nvme0n1p3
cryptsetup open /dev/nvme0n1p3 luks_root

#Formatear particiones
mkfs.vfat -n “EFI System” /dev/nvme0n1p1
mkfs.ext4 -L boot /dev/nvme0n1p2
mkfs.ext4 -L root /dev/mapper/luks_root

# Montar particiones
mount /dev/mapper/luks_root /mnt
mkdir /mnt/boot
mount /dev/nvme0n1p2 /mnt/boot
mkdir /mnt/boot/efi
mount /dev/nvme0n1p1 /mnt/boot/efi

# Crear swap (como swapfile)
cd /mnt
dd if=/dev/zero of=swap bs=1M count=2048
mkswap swap
swapon swap
chmod 0600 swap

# Instalar sistema base
pacstrap -i /mnt base base-devel efibootmgr grub linux linux-firmware \
 networkmanager sudo vim bash-completion neovim man-db iproute2 \
intel-ucode udev

# removed man-info vi

genfstab -U /mnt >> /mnt/etc/fstab

# Configuración del sistema base
arch-chroot /mnt

# añadir nuevo usuario
useradd -m -s /bin/bash ajramos
passwd ajramos

# configurar sudo
EDITOR=/usr/bin/vim visudo
añadir permisos y default editor

# configurar locale
ln -sf /usr/share/zoneinfo/Region/City /etc/localtime
hwclock --systohc

#descomentar es_ES.UTF-8 en 
vim /etc/locale.gen

locale-gen

echo "LANG=es_ES.UTF-8" > /etc/locale.conf
echo "KEYMAP=es" > /etc/vconsole.conf

# configurar red
echo "your-host-name" > /etc/hostname

vi /etc/hosts
127.0.0.1 localhost
::1 localhost
127.0.1.1 your-host-name.localdomain your-host-name

# configurar grub
vi /etc/default/grub
GRUB_CMDLINE_LINUX=”cryptdevice=/dev/nvme0n1p3:luks_root”

#en la linea de HOOKS añadir "encrypt" entre block y filesystem
vim /etc/mkinitcpio.conf

mkinitcpio -p linux

# instalar grub
grub-install --boot-directory=/boot --efi-directory=/boot/efi /dev/nvme0n1p2
grub-mkconfig -o /boot/grub/grub.cfg
grub-mkconfig -o /boot/efi/EFI/arch/grub.cfg

# Salir y reiniciar
exit 
reboot

# Al reiniciar lanzar y habilitar el NetworkManager
sudo systemctl start NetworkManager
sudo systemctl enable NetworkManager

# Instalar micro code
sudo pacman -S intel-ucode
sudo grub-mkconfig -o /boot/grub/grub.cfg
```
